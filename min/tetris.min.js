(function(){'use strict';var e=void 0,i=null,j,m=this;function p(){}
function q(a){var b=typeof a;if(b=="object")if(a){if(a instanceof Array)return"array";else if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if(c=="[object Window]")return"object";if(c=="[object Array]"||typeof a.length=="number"&&typeof a.splice!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("splice"))return"array";if(c=="[object Function]"||typeof a.call!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if(b=="function"&&typeof a.call=="undefined")return"object";return b}function r(a){return q(a)=="array"}function aa(a){var b=q(a);return b=="array"||b=="object"&&typeof a.length=="number"}function s(a){return typeof a=="string"}function ba(a){return a[ca]||(a[ca]=++da)}var ca="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36),da=0;function ea(a,b,c){return a.call.apply(a.bind,arguments)}
function fa(a,b,c){var d=b||m;if(arguments.length>2){var f=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(b,f);return a.apply(d,b)}}else return function(){return a.apply(d,arguments)}}function ga(a,b,c){ga=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?ea:fa;return ga.apply(i,arguments)}var ha=Date.now||function(){return+new Date};
function t(a,b){function c(){}c.prototype=b.prototype;a.$=b.prototype;a.prototype=new c};function ia(a,b){for(var c=1;c<arguments.length;c++)var d=String(arguments[c]).replace(/\$/g,"$$$$"),a=a.replace(/\%s/,d);return a}var ja=/^[a-zA-Z0-9\-_.!~*'()]*$/;function ka(a){a=String(a);return!ja.test(a)?encodeURIComponent(a):a}function la(a){return decodeURIComponent(a.replace(/\+/g," "))}
function ma(a){if(!na.test(a))return a;a.indexOf("&")!=-1&&(a=a.replace(oa,"&amp;"));a.indexOf("<")!=-1&&(a=a.replace(pa,"&lt;"));a.indexOf(">")!=-1&&(a=a.replace(qa,"&gt;"));a.indexOf('"')!=-1&&(a=a.replace(ra,"&quot;"));return a}var oa=/&/g,pa=/</g,qa=/>/g,ra=/\"/g,na=/[&<>\"]/;
function sa(a,b){for(var c=0,d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),f=String(b).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),g=Math.max(d.length,f.length),h=0;c==0&&h<g;h++){var k=d[h]||"",l=f[h]||"",n=/(\d*)(\D*)/g,Q=/(\d*)(\D*)/g;do{var o=n.exec(k)||["","",""],x=Q.exec(l)||["","",""];if(o[0].length==0&&x[0].length==0)break;c=ta(o[1].length==0?0:parseInt(o[1],10),x[1].length==0?0:parseInt(x[1],10))||ta(o[2].length==0,x[2].length==0)||ta(o[2],x[2])}while(c==0)}return c}
function ta(a,b){if(a<b)return-1;else if(a>b)return 1;return 0};var ua=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([\\w\\d\\-\\u0100-\\uffff.%]*)(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function va(a){var b=u,c;for(c in b)a.call(e,b[c],c,b)}function wa(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function xa(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var ya="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function za(a,b){for(var c,d,f=1;f<arguments.length;f++){d=arguments[f];for(c in d)a[c]=d[c];for(var g=0;g<ya.length;g++)c=ya[g],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Aa=Array.prototype,Ba=Aa.indexOf?function(a,b,c){return Aa.indexOf.call(a,b,c)}:function(a,b,c){c=c==i?0:c<0?Math.max(0,a.length+c):c;if(s(a))return!s(b)||b.length!=1?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Ca=Aa.forEach?function(a,b,c){Aa.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=s(a)?a.split(""):a,g=0;g<d;g++)g in f&&b.call(c,f[g],g,a)};
function Da(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c],f;if(r(d)||(f=aa(d))&&d.hasOwnProperty("callee"))a.push.apply(a,d);else if(f)for(var g=a.length,h=d.length,k=0;k<h;k++)a[g+k]=d[k];else a.push(d)}};function Ea(a){if(typeof a.L=="function")return a.L();if(s(a))return a.split("");if(aa(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return wa(a)}function Fa(a,b,c){if(typeof a.forEach=="function")a.forEach(b,c);else if(aa(a)||s(a))Ca(a,b,c);else{var d;if(typeof a.R=="function")d=a.R();else if(typeof a.L!="function")if(aa(a)||s(a)){d=[];for(var f=a.length,g=0;g<f;g++)d.push(g)}else d=xa(a);else d=e;for(var f=Ea(a),g=f.length,h=0;h<g;h++)b.call(c,f[h],d&&d[h],a)}};function Ga(a,b){this.w={};this.c=[];var c=arguments.length;if(c>1){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){a instanceof Ga?(c=a.R(),d=a.L()):(c=xa(a),d=wa(a));for(var f=0;f<c.length;f++)this.set(c[f],d[f])}}j=Ga.prototype;j.d=0;j.$a=0;j.L=function(){Ha(this);for(var a=[],b=0;b<this.c.length;b++)a.push(this.w[this.c[b]]);return a};j.R=function(){Ha(this);return this.c.concat()};j.G=function(a){return v(this.w,a)};
j.remove=function(a){return v(this.w,a)?(delete this.w[a],this.d--,this.$a++,this.c.length>2*this.d&&Ha(this),!0):!1};function Ha(a){if(a.d!=a.c.length){for(var b=0,c=0;b<a.c.length;){var d=a.c[b];v(a.w,d)&&(a.c[c++]=d);b++}a.c.length=c}if(a.d!=a.c.length){for(var f={},c=b=0;b<a.c.length;)d=a.c[b],v(f,d)||(a.c[c++]=d,f[d]=1),b++;a.c.length=c}}j.get=function(a,b){return v(this.w,a)?this.w[a]:b};j.set=function(a,b){v(this.w,a)||(this.d++,this.c.push(a),this.$a++);this.w[a]=b};j.ca=function(){return new Ga(this)};
function v(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Ia(a,b){var c;a instanceof Ia?(this.Z(b==i?a.q:b),Ja(this,a.D),Ka(this,a.na),La(this,a.H),Ma(this,a.V),Na(this,a.N),Oa(this,a.z.ca()),Pa(this,a.ea)):a&&(c=String(a).match(ua))?(this.Z(!!b),Ja(this,c[1]||"",!0),Ka(this,c[2]||"",!0),La(this,c[3]||"",!0),Ma(this,c[4]),Na(this,c[5]||"",!0),Oa(this,c[6]||"",!0),Pa(this,c[7]||"",!0)):(this.Z(!!b),this.z=new Qa(i,this,this.q))}j=Ia.prototype;j.D="";j.na="";j.H="";j.V=i;j.N="";j.ea="";j.gb=!1;j.q=!1;
j.toString=function(){if(this.m)return this.m;var a=[];this.D&&a.push(Ra(this.D,Sa),":");this.H&&(a.push("//"),this.na&&a.push(Ra(this.na,Sa),"@"),a.push(s(this.H)?encodeURIComponent(this.H):i),this.V!=i&&a.push(":",String(this.V)));this.N&&(this.H&&this.N.charAt(0)!="/"&&a.push("/"),a.push(Ra(this.N,Ta)));var b=String(this.z);b&&a.push("?",b);this.ea&&a.push("#",Ra(this.ea,Ua));return this.m=a.join("")};
j.ca=function(){var a=this.D,b=this.na,c=this.H,d=this.V,f=this.N,g=this.z.ca(),h=this.ea,k=new Ia(i,this.q);a&&Ja(k,a);b&&Ka(k,b);c&&La(k,c);d&&Ma(k,d);f&&Na(k,f);g&&Oa(k,g);h&&Pa(k,h);return k};function Ja(a,b,c){w(a);delete a.m;a.D=c?b?decodeURIComponent(b):"":b;if(a.D)a.D=a.D.replace(/:$/,"")}function Ka(a,b,c){w(a);delete a.m;a.na=c?b?decodeURIComponent(b):"":b}function La(a,b,c){w(a);delete a.m;a.H=c?b?decodeURIComponent(b):"":b}
function Ma(a,b){w(a);delete a.m;if(b){b=Number(b);if(isNaN(b)||b<0)throw Error("Bad port number "+b);a.V=b}else a.V=i}function Na(a,b,c){w(a);delete a.m;a.N=c?b?decodeURIComponent(b):"":b}function Oa(a,b,c){w(a);delete a.m;b instanceof Qa?(a.z=b,a.z.Ha=a,a.z.Z(a.q)):(c||(b=Ra(b,Va)),a.z=new Qa(b,a,a.q))}function Pa(a,b,c){w(a);delete a.m;a.ea=c?b?decodeURIComponent(b):"":b}function w(a){if(a.gb)throw Error("Tried to modify a read-only Uri");}j.Z=function(a){this.q=a;this.z&&this.z.Z(a);return this};
var Wa=/^[a-zA-Z0-9\-_.!~*'():\/;?]*$/;function Ra(a,b){var c=i;s(a)&&(c=a,Wa.test(c)||(c=encodeURI(a)),c.search(b)>=0&&(c=c.replace(b,Xa)));return c}function Xa(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Sa=/[#\/\?@]/g,Ta=/[\#\?]/g,Va=/[\#\?@]/g,Ua=/#/g;function Qa(a,b,c){this.u=a||i;this.Ha=b||i;this.q=!!c}
function y(a){if(!a.e&&(a.e=new Ga,a.u))for(var b=a.u.split("&"),c=0;c<b.length;c++){var d=b[c].indexOf("="),f=i,g=i;d>=0?(f=b[c].substring(0,d),g=b[c].substring(d+1)):f=b[c];f=la(f);f=z(a,f);a.add(f,g?la(g):"")}}j=Qa.prototype;j.e=i;j.d=i;j.add=function(a,b){y(this);Ya(this);a=z(this,a);if(this.G(a)){var c=this.e.get(a);r(c)?c.push(b):this.e.set(a,[c,b])}else this.e.set(a,b);this.d++;return this};
j.remove=function(a){y(this);a=z(this,a);if(this.e.G(a)){Ya(this);var b=this.e.get(a);r(b)?this.d-=b.length:this.d--;return this.e.remove(a)}return!1};j.G=function(a){y(this);a=z(this,a);return this.e.G(a)};j.R=function(){y(this);for(var a=this.e.L(),b=this.e.R(),c=[],d=0;d<b.length;d++){var f=a[d];if(r(f))for(var g=0;g<f.length;g++)c.push(b[d]);else c.push(b[d])}return c};
j.L=function(a){y(this);if(a)if(a=z(this,a),this.G(a)){var b=this.e.get(a);if(r(b))return b;else a=[],a.push(b)}else a=[];else for(var b=this.e.L(),a=[],c=0;c<b.length;c++){var d=b[c];r(d)?Da(a,d):a.push(d)}return a};j.set=function(a,b){y(this);Ya(this);a=z(this,a);if(this.G(a)){var c=this.e.get(a);r(c)?this.d-=c.length:this.d--}this.e.set(a,b);this.d++;return this};j.get=function(a,b){y(this);a=z(this,a);if(this.G(a)){var c=this.e.get(a);return r(c)?c[0]:c}else return b};
j.toString=function(){if(this.u)return this.u;if(!this.e)return"";for(var a=[],b=0,c=this.e.R(),d=0;d<c.length;d++){var f=c[d],g=ka(f),f=this.e.get(f);if(r(f))for(var h=0;h<f.length;h++)b>0&&a.push("&"),a.push(g),f[h]!==""&&a.push("=",ka(f[h])),b++;else b>0&&a.push("&"),a.push(g),f!==""&&a.push("=",ka(f)),b++}return this.u=a.join("")};function Ya(a){delete a.ya;delete a.u;a.Ha&&delete a.Ha.m}j.ca=function(){var a=new Qa;if(this.ya)a.ya=this.ya;if(this.u)a.u=this.u;if(this.e)a.e=this.e.ca();return a};
function z(a,b){var c=String(b);a.q&&(c=c.toLowerCase());return c}j.Z=function(a){a&&!this.q&&(y(this),Ya(this),Fa(this.e,function(a,c){var d=c.toLowerCase();c!=d&&(this.remove(c),this.add(d,a))},this));this.q=a};var A,Za,$a,ab;function bb(){return m.navigator?m.navigator.userAgent:i}ab=$a=Za=A=!1;var cb;if(cb=bb()){var db=m.navigator;A=cb.indexOf("Opera")==0;Za=!A&&cb.indexOf("MSIE")!=-1;$a=!A&&cb.indexOf("WebKit")!=-1;ab=!A&&!$a&&db.product=="Gecko"}var eb=A,B=Za,C=ab,fb=$a,gb=m.navigator,hb=(gb&&gb.platform||"").indexOf("Mac")!=-1,ib;
a:{var jb="",kb;if(eb&&m.opera)var lb=m.opera.version,jb=typeof lb=="function"?lb():lb;else if(C?kb=/rv\:([^\);]+)(\)|;)/:B?kb=/MSIE\s+([^\);]+)(\)|;)/:fb&&(kb=/WebKit\/(\S+)/),kb)var mb=kb.exec(bb()),jb=mb?mb[1]:"";if(B){var nb,ob=m.document;nb=ob?ob.documentMode:e;if(nb>parseFloat(jb)){ib=String(nb);break a}}ib=jb}var pb={};function D(a){return pb[a]||(pb[a]=sa(ib,a)>=0)};var qb;!B||D("9");B&&D("8");function F(){}F.prototype.Oa=!1;F.prototype.da=function(){if(!this.Oa)this.Oa=!0,this.i()};F.prototype.i=function(){};function G(a,b){this.type=a;this.currentTarget=this.target=b}t(G,F);G.prototype.i=function(){delete this.type;delete this.target;delete this.currentTarget};G.prototype.W=!1;G.prototype.ta=!0;var rb=new Function("a","return a");function sb(a,b){a&&this.qa(a,b)}t(sb,G);j=sb.prototype;j.target=i;j.relatedTarget=i;j.offsetX=0;j.offsetY=0;j.clientX=0;j.clientY=0;j.screenX=0;j.screenY=0;j.button=0;j.keyCode=0;j.charCode=0;j.ctrlKey=!1;j.altKey=!1;j.shiftKey=!1;j.metaKey=!1;j.mb=!1;j.Aa=i;
j.qa=function(a,b){var c=this.type=a.type;G.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(C)try{rb(d.nodeName)}catch(f){d=i}}else if(c=="mouseover")d=a.fromElement;else if(c=="mouseout")d=a.toElement;this.relatedTarget=d;this.offsetX=a.offsetX!==e?a.offsetX:a.layerX;this.offsetY=a.offsetY!==e?a.offsetY:a.layerY;this.clientX=a.clientX!==e?a.clientX:a.pageX;this.clientY=a.clientY!==e?a.clientY:a.pageY;this.screenX=a.screenX||0;this.screenY=a.screenY||
0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||(c=="keypress"?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.mb=hb?a.metaKey:a.ctrlKey;this.state=a.state;this.Aa=a;delete this.ta;delete this.W};j.i=function(){sb.$.i.call(this);this.relatedTarget=this.currentTarget=this.target=this.Aa=i};function tb(){}var ub=0;j=tb.prototype;j.key=0;j.X=!1;j.Ka=!1;j.qa=function(a,b,c,d,f,g){if(q(a)=="function")this.Pa=!0;else if(a&&a.handleEvent&&q(a.handleEvent)=="function")this.Pa=!1;else throw Error("Invalid listener argument");this.ia=a;this.Sa=b;this.src=c;this.type=d;this.capture=!!f;this.Ca=g;this.Ka=!1;this.key=++ub;this.X=!1};j.handleEvent=function(a){return this.Pa?this.ia.call(this.Ca||this.src,a):this.ia.handleEvent.call(this.ia,a)};var vb,wb=(vb="ScriptEngine"in m&&m.ScriptEngine()=="JScript")?m.ScriptEngineMajorVersion()+"."+m.ScriptEngineMinorVersion()+"."+m.ScriptEngineBuildVersion():"0";function H(a,b){this.Qa=b;this.K=[];if(a>this.Qa)throw Error("[goog.structs.SimplePool] Initial cannot be greater than max");for(var c=0;c<a;c++)this.K.push(this.s?this.s():{})}t(H,F);H.prototype.s=i;H.prototype.Na=i;H.prototype.getObject=function(){return this.K.length?this.K.pop():this.s?this.s():{}};function I(a,b){a.K.length<a.Qa?a.K.push(b):xb(a,b)}
function xb(a,b){if(a.Na)a.Na(b);else{var c=q(b);if(c=="object"||c=="array"||c=="function")if(q(b.da)=="function")b.da();else for(var d in b)delete b[d]}}H.prototype.i=function(){H.$.i.call(this);for(var a=this.K;a.length;)xb(this,a.pop());delete this.K};var yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb,Ib;
(function(){function a(){return{d:0,l:0}}function b(){return[]}function c(){function a(b){return h.call(a.src,a.key,b)}return a}function d(){return new tb}function f(){return new sb}var g=vb&&!(sa(wb,"5.7")>=0),h;Db=function(a){h=a};if(g){yb=function(){return k.getObject()};zb=function(a){I(k,a)};Ab=function(){return l.getObject()};Bb=function(a){I(l,a)};Cb=function(){return n.getObject()};Eb=function(){I(n,c())};Fb=function(){return Q.getObject()};Gb=function(a){I(Q,a)};Hb=function(){return o.getObject()};
Ib=function(a){I(o,a)};var k=new H(0,600);k.s=a;var l=new H(0,600);l.s=b;var n=new H(0,600);n.s=c;var Q=new H(0,600);Q.s=d;var o=new H(0,600);o.s=f}else yb=a,zb=p,Ab=b,Bb=p,Cb=c,Eb=p,Fb=d,Gb=p,Hb=f,Ib=p})();var J={},K={},u={},L={};
function Jb(a,b,c,d,f){if(b)if(r(b)){for(var g=0;g<b.length;g++)Jb(a,b[g],c,d,f);return i}else{var d=!!d,h=K;b in h||(h[b]=yb());h=h[b];d in h||(h[d]=yb(),h.d++);var h=h[d],k=ba(a),l;h.l++;if(h[k]){l=h[k];for(g=0;g<l.length;g++)if(h=l[g],h.ia==c&&h.Ca==f){if(h.X)break;return l[g].key}}else l=h[k]=Ab(),h.d++;g=Cb();g.src=a;h=Fb();h.qa(c,g,a,b,d,f);c=h.key;g.key=c;l.push(h);J[c]=h;u[k]||(u[k]=Ab());u[k].push(h);a.addEventListener?(a==m||!a.Ma)&&a.addEventListener(b,g,d):a.attachEvent(b in L?L[b]:L[b]=
"on"+b,g);return c}else throw Error("Invalid event type");}function Kb(a,b,c,d,f){if(r(b))for(var g=0;g<b.length;g++)Kb(a,b[g],c,d,f);else{d=!!d;a:{g=K;if(b in g&&(g=g[b],d in g&&(g=g[d],a=ba(a),g[a]))){a=g[a];break a}a=i}if(a)for(g=0;g<a.length;g++)if(a[g].ia==c&&a[g].capture==d&&a[g].Ca==f){M(a[g].key);break}}}
function M(a){if(J[a]){var b=J[a];if(!b.X){var c=b.src,d=b.type,f=b.Sa,g=b.capture;c.removeEventListener?(c==m||!c.Ma)&&c.removeEventListener(d,f,g):c.detachEvent&&c.detachEvent(d in L?L[d]:L[d]="on"+d,f);c=ba(c);f=K[d][g][c];if(u[c]){var h=u[c],k=Ba(h,b);k>=0&&Aa.splice.call(h,k,1);h.length==0&&delete u[c]}b.X=!0;f.Ra=!0;Lb(d,g,c,f);delete J[a]}}}
function Lb(a,b,c,d){if(!d.ra&&d.Ra){for(var f=0,g=0;f<d.length;f++)if(d[f].X){var h=d[f].Sa;h.src=i;Eb(h);Gb(d[f])}else f!=g&&(d[g]=d[f]),g++;d.length=g;d.Ra=!1;g==0&&(Bb(d),delete K[a][b][c],K[a][b].d--,K[a][b].d==0&&(zb(K[a][b]),delete K[a][b],K[a].d--),K[a].d==0&&(zb(K[a]),delete K[a]))}}
function Mb(a){var b,c=0,d=b==i;b=!!b;if(a==i)va(function(a){for(var f=a.length-1;f>=0;f--){var g=a[f];if(d||b==g.capture)M(g.key),c++}});else if(a=ba(a),u[a])for(var a=u[a],f=a.length-1;f>=0;f--){var g=a[f];if(d||b==g.capture)M(g.key),c++}}function Nb(a,b,c,d,f){var g=1,b=ba(b);if(a[b]){a.l--;a=a[b];a.ra?a.ra++:a.ra=1;try{for(var h=a.length,k=0;k<h;k++){var l=a[k];l&&!l.X&&(g&=Ob(l,f)!==!1)}}finally{a.ra--,Lb(c,d,b,a)}}return Boolean(g)}
function Ob(a,b){var c=a.handleEvent(b);a.Ka&&M(a.key);return c}
Db(function(a,b){if(!J[a])return!0;var c=J[a],d=c.type,f=K;if(!(d in f))return!0;var f=f[d],g,h;qb===e&&(qb=B&&!m.addEventListener);if(qb){var k;if(!(k=b))a:{k="window.event".split(".");for(var l=m;g=k.shift();)if(l[g]!=i)l=l[g];else{k=i;break a}k=l}g=k;k=!0 in f;l=!1 in f;if(k){if(g.keyCode<0||g.returnValue!=e)return!0;a:{var n=!1;if(g.keyCode==0)try{g.keyCode=-1;break a}catch(Q){n=!0}if(n||g.returnValue==e)g.returnValue=!0}}n=Hb();n.qa(g,this);g=!0;try{if(k){for(var o=Ab(),x=n.currentTarget;x;x=
x.parentNode)o.push(x);h=f[!0];h.l=h.d;for(var E=o.length-1;!n.W&&E>=0&&h.l;E--)n.currentTarget=o[E],g&=Nb(h,o[E],d,!0,n);if(l){h=f[!1];h.l=h.d;for(E=0;!n.W&&E<o.length&&h.l;E++)n.currentTarget=o[E],g&=Nb(h,o[E],d,!1,n)}}else g=Ob(c,n)}finally{if(o)o.length=0,Bb(o);n.da();Ib(n)}return g}d=new sb(b,this);try{g=Ob(c,d)}finally{d.da()}return g});function N(a,b){G.call(this,"navigate");this.ub=a;this.rb=b}t(N,G);function O(){}t(O,F);j=O.prototype;j.Ma=!0;j.Ea=i;j.addEventListener=function(a,b,c,d){Jb(this,a,b,c,d)};j.removeEventListener=function(a,b,c,d){Kb(this,a,b,c,d)};
j.dispatchEvent=function(a){var b=a.type||a,c=K;if(b in c){if(s(a))a=new G(a,this);else if(a instanceof G)a.target=a.target||this;else{var d=a,a=new G(b,this);za(a,d)}var d=1,f,c=c[b],b=!0 in c,g;if(b){f=[];for(g=this;g;g=g.Ea)f.push(g);g=c[!0];g.l=g.d;for(var h=f.length-1;!a.W&&h>=0&&g.l;h--)a.currentTarget=f[h],d&=Nb(g,f[h],a.type,!0,a)&&a.ta!=!1}if(!1 in c)if(g=c[!1],g.l=g.d,b)for(h=0;!a.W&&h<f.length&&g.l;h++)a.currentTarget=f[h],d&=Nb(g,f[h],a.type,!1,a)&&a.ta!=!1;else for(f=this;!a.W&&f&&g.l;f=
f.Ea)a.currentTarget=f,d&=Nb(g,f,a.type,!1,a)&&a.ta!=!1;a=Boolean(d)}else a=!0;return a};j.i=function(){O.$.i.call(this);Mb(this);this.Ea=i};function Pb(a,b){this.f=a||window;this.va=b||i;Jb(this.f,"popstate",this.ja,!1,this);Jb(this.f,"hashchange",this.ja,!1,this)}t(Pb,O);j=Pb.prototype;j.t=!1;j.ma=!0;j.ka="/";j.Y=function(a){if(a!=this.t)(this.t=a)&&this.dispatchEvent(new N(this.o(),!1))};j.o=function(){if(this.ma){var a=this.f.location.href,b=a.indexOf("#");return b<0?"":a.substring(b+1)}else return this.va?this.va.sb(this.ka,this.f.location):this.f.location.pathname.substr(this.ka.length)};
j.Va=function(a,b){a!=this.o()&&(this.f.history.pushState(i,b||this.f.document.title||"",this.ma?"#"+a:this.va?this.va.qb(a,this.ka,this.f.location):this.ka+a+this.f.location.search),this.dispatchEvent(new N(a,!1)))};j.i=function(){Kb(this.f,"popstate",this.ja,!1,this);this.ma&&Kb(this.f,"hashchange",this.ja,!1,this)};j.ja=function(){this.t&&this.dispatchEvent(new N(this.o(),!0))};function Qb(a,b){this.ga=a||1;this.la=b||Rb;this.wa=ga(this.ob,this);this.Da=ha()}t(Qb,O);Qb.prototype.enabled=!1;var Rb=m.window;j=Qb.prototype;j.h=i;j.setInterval=function(a){this.ga=a;this.h&&this.enabled?(this.stop(),this.start()):this.h&&this.stop()};j.ob=function(){if(this.enabled){var a=ha()-this.Da;if(a>0&&a<this.ga*0.8)this.h=this.la.setTimeout(this.wa,this.ga-a);else if(this.dispatchEvent(Sb),this.enabled)this.h=this.la.setTimeout(this.wa,this.ga),this.Da=ha()}};
j.start=function(){this.enabled=!0;if(!this.h)this.h=this.la.setTimeout(this.wa,this.ga),this.Da=ha()};j.stop=function(){this.enabled=!1;if(this.h)this.la.clearTimeout(this.h),this.h=i};j.i=function(){Qb.$.i.call(this);this.stop();delete this.la};var Sb="tick";function Tb(a){this.fb=a}t(Tb,F);var Ub=new H(0,100),Vb=[];function Wb(a,b,c,d){r(c)||(Vb[0]=c,c=Vb);for(var f=0;f<c.length;f++){var g=a,h=Jb(b,c[f],d||a,!1,a.fb||a);g.c?g.c[h]=!0:g.ha?(g.c=Ub.getObject(),g.c[g.ha]=!0,g.ha=i,g.c[h]=!0):g.ha=h}}function Xb(a){if(a.c){for(var b in a.c)M(b),delete a.c[b];I(Ub,a.c);a.c=i}else a.ha&&M(a.ha)}Tb.prototype.i=function(){Tb.$.i.call(this);Xb(this)};Tb.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};!B||D("9");!C&&!B||B&&D("9")||C&&D("1.9.1");B&&D("9");function P(a){return s(a)?document.getElementById(a):a}function Yb(){var a=document;return a.querySelectorAll&&a.querySelector&&(!fb||document.compatMode=="CSS1Compat"||D("528"))?a.querySelectorAll("TITLE"):a.getElementsByTagName("TITLE")};function R(a,b,c,d){if(a&&!b)throw Error("Can't use invisible history without providing a blank page.");var f;c?f=c:(f="history_state"+Zb,document.write(ia($b,f,f)),f=P(f));this.fa=f;this.f=c?(c.nodeType==9?c:c.ownerDocument||c.document)?(c.nodeType==9?c:c.ownerDocument||c.document).parentWindow||(c.nodeType==9?c:c.ownerDocument||c.document).defaultView:window:window;this.ab=this.f.location.href.split("#")[0]+"#";this.pa=b;if(B&&!b)this.pa=window.location.protocol=="https"?"https:///":'javascript:""';
this.h=new Qb(ac);this.O=!a;this.J=new Tb(this);if(a||B&&!S)d?a=d:(a="history_iframe"+Zb,b=this.pa?'src="'+ma(this.pa)+'"':"",document.write(ia(bc,a,b)),a=P(a)),this.p=a,this.Za=!0;if(B&&!S)Wb(this.J,this.f,"load",this.hb),this.Wa=this.za=!1;this.O?cc(this,this.o(),!0):T(this,this.fa.value);Zb++}t(R,O);R.prototype.t=!1;R.prototype.U=!1;R.prototype.S=i;var S=B&&document.documentMode>=8||C&&D("1.9.2")||fb&&D("532.1");j=R.prototype;j.T=i;j.i=function(){R.$.i.call(this);this.J.da();this.Y(!1)};
j.Y=function(a){if(a!=this.t)if(B&&!S&&!this.za)this.Wa=a;else if(a)if(eb?Wb(this.J,this.f.document,dc,this.kb):C&&Wb(this.J,this.f,"pageshow",this.jb),S&&this.O)Wb(this.J,this.f,"hashchange",this.ib),this.t=!0,this.dispatchEvent(new N(this.o(),!1));else{if(!B||this.za){Wb(this.J,this.h,Sb,ga(this.La,this,!0));this.t=!0;if(!B)this.S=this.o();this.h.start();this.dispatchEvent(new N(this.o(),!1))}}else this.t=!1,Xb(this.J),this.h.stop()};
j.hb=function(){this.za=!0;this.fa.value&&T(this,this.fa.value,!0);this.Y(this.Wa)};j.jb=function(a){a.Aa.persisted&&(this.Y(!1),this.Y(!0))};j.ib=function(){var a=ec(this.f);a!=this.S&&fc(this,a,!0)};j.o=function(){return this.T!=i?this.T:this.O?ec(this.f):gc(this)||""};j.Va=function(a,b){if(this.o()!=a)this.O?(cc(this,a,!1),S||B&&T(this,a,!1,b),this.t&&this.La(!1)):(T(this,a,!1),this.T=this.S=this.fa.value=a,this.dispatchEvent(new N(a,!1)))};
function ec(a){var a=a.location.href,b=a.indexOf("#");return b<0?"":a.substring(b+1)}function cc(a,b,c){b=a.ab+(b||"");a=a.f.location;if(b!=a.href)c?a.replace(b):a.href=b}function T(a,b,c,d){if(a.Za||b!=gc(a))if(a.Za=!1,b=ka(b),B){var f=fb?a.p.document||a.p.contentWindow.document:a.p.contentDocument||a.p.contentWindow.document;f.open("text/html",c?"replace":e);f.write(ia(hc,ma(d||a.f.document.title),b));f.close()}else if(b=a.pa+"#"+b,a=a.p.contentWindow)c?a.location.replace(b):a.location.href=b}
function gc(a){if(B)return a=fb?a.p.document||a.p.contentWindow.document:a.p.contentDocument||a.p.contentWindow.document,a.body?la(a.body.innerHTML):i;else{var b=a.p.contentWindow;if(b){var c;try{c=la(ec(b))}catch(d){if(!a.U)a.U!=!0&&a.h.setInterval(ic),a.U=!0;return i}if(a.U)a.U!=!1&&a.h.setInterval(ac),a.U=!1;return c||i}else return i}}j.La=function(a){if(this.O){var b=ec(this.f);b!=this.S&&fc(this,b,a)}if(!this.O||B&&!S)if(b=gc(this)||"",this.T==i||b==this.T)this.T=i,b!=this.S&&fc(this,b,a)};
function fc(a,b,c){a.S=a.fa.value=b;a.O?(B&&!S&&T(a,b),cc(a,b)):T(a,b);a.dispatchEvent(new N(a.o(),c))}j.kb=function(){this.h.stop();this.h.start()};var dc=["mousedown","keydown","mousemove"],hc="<title>%s</title><body>%s</body>",bc='<iframe id="%s" style="display:none" %s></iframe>',$b='<input type="text" name="%s" id="%s" style="display:none" />',Zb=0,ac=150,ic=1E4;var U={b:{}};U.b.g=10;U.b.oa=22;var jc;jc=(new Ia(document.location.href)).N;var kc=window;if(kc.history&&kc.history.pushState){U.b.history=new Pb;var lc=U.b.history;if(lc.ma!=!1)Kb(lc.f,"hashchange",lc.ja,!1,lc),lc.ma=!1;U.b.history.ka=jc}else U.b.history=new R;U.b.history.Y(!0);U.b.r=function(a,b){return a<0||a>=U.b.g||b<0||b>=U.b.oa||U.j[b*U.b.g+a].r?!0:!1};U.b.ba=function(a){var b,c,d;for(c=0;c<4;c++)if(b=U.a.aa[a.pattern][a.rotation][c],d=b[0]/20+a.x/20,b=b[1]/20+a.y/20,U.b.r(d,b))return 0;return 1};
U.b.cb=function(a,b,c){var d,f,g,h=0;for(d=U.b.oa;d>=0;){for(f=0;f<U.b.g;++f)if(!U.j[d*U.b.g+f].r)break;if(f===U.b.g){U.P.ua+=U.F.M*[40,100,300,1200][h];h++;for(g=d-1;g>=0;g--)for(f=0;f<U.b.g;++f)U.j[(g+1)*U.b.g+f].r=U.j[g*U.b.g+f].r,U.j[(g+1)*U.b.g+f].color=U.j[g*U.b.g+f].color;for(f=0;f<=U.b.g;f++)U.j[f].r=!1;U.a.Ta(a,b,c);U.b.Ga()}else d--}U.Fa.k+=h;U.F.M=1+Math.floor(U.Fa.k/4);U.b.Ga();U.b.pb()};U.b.Xa=function(){U.a.Ya(mc);U.b.history.Va("#Next: "+U.a.aa[mc.pattern][4])};
U.b.v=function(){var a;for(a=0;a<U.b.g&&U.v.end===!1;a++)if(U.b.r(a,0))clearInterval(U.C.B),U.P.Ja.push(U.P.ua),nc.innerHTML="Game Over",document.onkeydown=function(a){(a===i?window.event.keyCode:a.keyCode)===82&&U.sa()},U.v.end=!0};U.b.Ga=function(){oc.innerHTML="Score: "+U.P.ua+" / Level: "+U.F.M+" / Speed: "+U.A.k};U.b.pb=function(){var a=100;U.A.k=U.F.M>=5?200-(U.F.M-4)*10:800-(U.F.M-1)*a;clearInterval(U.C.B);U.C.B=setInterval(function(){U.a.move(V,W,X,Y)},U.A.k)};
U.b.tb=function(a){var b=new Date;for(b.setTime(b.getTime()+a);(new Date).getTime()<b.getTime();)U.b.key()};U.b.key=function(){document.onkeydown=function(a){switch(a===i?window.event.keyCode:a.keyCode){case 37:U.Q||U.a.xa(-20,0);break;case 38:U.Q||U.a.rotation(V,W,X,Y);break;case 39:U.Q||U.a.xa(20,0);break;case 40:U.Q||U.a.xa(0,20);break;case 32:U.a.eb();break;case 80:U.lb();break;case 82:U.sa()}}};function pc(){this.Ua=ha()}new pc;pc.prototype.set=function(a){this.Ua=a};pc.prototype.get=function(){return this.Ua};U.a={};
U.a.aa=[[[[0,20],[20,20],[40,20],[60,20]],[[20,0],[20,20],[20,40],[20,60]],[[0,20],[20,20],[40,20],[60,20]],[[20,0],[20,20],[20,40],[20,60]],"\u28b8"],[[[20,0],[20,20],[40,20],[60,20]],[[20,0],[40,0],[20,20],[20,40]],[[0,20],[20,20],[40,20],[40,40]],[[20,0],[20,20],[0,40],[20,40]],"\u280f"],[[[40,0],[0,20],[20,20],[40,20]],[[20,0],[20,20],[20,40],[40,40]],[[0,20],[20,20],[40,20],[0,40]],[[0,0],[20,0],[20,20],[20,40]],"\u2839"],[[[20,0],[40,0],[20,20],[40,20]],[[20,0],[40,0],[20,20],[40,20]],[[20,
0],[40,0],[20,20],[40,20]],[[20,0],[40,0],[20,20],[40,20]],"\u2836"],[[[20,20],[40,20],[0,40],[20,40]],[[20,20],[20,40],[40,40],[40,60]],[[20,20],[40,20],[0,40],[20,40]],[[20,20],[20,40],[40,40],[40,60]],"\u2833"],[[[20,0],[0,20],[20,20],[40,20]],[[20,0],[20,20],[40,20],[20,40]],[[0,20],[20,20],[40,20],[20,40]],[[20,0],[0,20],[20,20],[20,40]],"\u2817"],[[[0,0],[20,0],[20,20],[40,20]],[[40,0],[20,20],[40,20],[20,40]],[[0,0],[20,0],[20,20],[40,20]],[[40,0],[20,20],[40,20],[20,40]],"\u281e"]];
U.a.Ia=[[0,0],[20,0],[40,0],[60,0],[80,0],[100,0],[120,0]];U.a.Ya=function(a){a.pattern=Math.floor(Math.random()*7);a.x=Math.floor(Math.random()*7)*20;a.y=0;a.rotation=0};U.a.n=function(a,b,c,d,f){var g,h;c.fillStyle=f;for(h=0;h<4;h++)g=U.a.aa[d.pattern][d.rotation][h],f==="black"?c.drawImage(qc,U.a.Ia[d.pattern][0],0,20,20,g[0]+d.x,g[1]+d.y,20,20):c.fillRect(g[0]+d.x,g[1]+d.y,20,20);a.drawImage(b,0,40,200,400,0,0,200,400)};
U.a.I=function(a,b,c,d){var f=Z,g,h;c.fillStyle=d;for(h=0;h<4;h++)g=U.a.aa[f.pattern][f.rotation][h],d==="black"?c.drawImage(qc,140,0,20,20,g[0]+f.x,g[1]+f.y,20,20):c.fillRect(g[0]+f.x,g[1]+f.y,20,20);a.drawImage(b,0,40,200,400,0,0,200,400)};U.a.Ta=function(a,b,c){var d,f,g;c.clearRect(0,0,200,440);a.clearRect(0,0,200,400);for(d=0;d<U.b.oa;d++)for(f=0;f<U.b.g;f++)U.j[d*U.b.g+f].r&&(g=U.a.Ia[U.j[d*U.b.g+f].color],c.drawImage(qc,g[0],0,20,20,f*20,d*20,20,20));a.drawImage(b,0,40,200,400,0,0,200,400)};
U.a.copy=function(a,b){b.x=a.x;b.y=a.y;b.pattern=a.pattern;b.rotation=a.rotation};U.a.rotation=function(a,b,c,d){var f=new $;U.a.copy(d,f);U.a.n(a,b,c,d,"white");U.a.I(a,b,c,"white");f.rotation=(f.rotation+1)%4;U.b.ba(f)&&(U.a.copy(f,d),U.a.copy(d,Z));U.a.Ba();U.a.I(a,b,c,"black");U.a.n(a,b,c,d,"black")};
U.a.xa=function(a,b){var c=V,d=W,f=X,g=Y,h=new $;U.a.copy(g,h);U.a.n(c,d,f,g,"white");U.a.I(c,d,f,"white");h.x+=a;h.y+=b;U.b.ba(h)&&(U.a.copy(h,g),U.a.copy(g,Z));U.a.Ba();U.a.I(c,d,f,"black");U.a.n(c,d,f,g,"black")};U.a.eb=function(){var a=V,b=W,c=X,d=Y;U.Q=!0;var f=new $;U.a.copy(d,f);U.a.n(a,b,c,d,"white");for(f.y+=20;U.b.ba(f);)U.a.copy(f,d),f.y+=20;U.a.n(a,b,c,d,"black")};U.a.Ba=function(){var a=new $;U.a.copy(Z,a);for(a.y+=20;U.b.ba(a);)U.a.copy(a,Z),a.y+=20};
U.a.move=function(a,b,c,d){var f,g,h;f=new $;U.a.copy(d,f);f.y+=20;U.b.key();U.a.I(a,b,c,"white");U.a.copy(d,Z);U.a.Ba();U.a.I(a,b,c,"black");if(U.b.ba(f))U.a.n(a,b,c,d,"white"),U.a.copy(f,d),U.a.n(a,b,c,d,"black");else{U.a.n(a,b,c,d,"black");for(f=0;f<4;f++)g=U.a.aa[d.pattern][d.rotation][f],h=g[0]/20+d.x/20,g=g[1]/20+d.y/20,U.j[g*U.b.g+h].r=!0,U.j[g*U.b.g+h].color=d.pattern;U.b.cb(a,b,c);U.b.v()||(U.a.copy(mc,d),U.a.copy(d,Z),U.b.Xa(),U.a.n(a,b,c,d,"black"))}U.Q=!1};/*
 This demo is my submission to the Mozilla Dev Derby of August 2011.
 This is basically a Tetris integrated into the browser UI. The next piece shape is listed in the URL bar, your score is in the title bar and hover the page to display instructions (yeah, I know, this one in annoying...).
 I've used the History API to display useful information about the game. Browser's back/next buttons are unused.
 Enter a harder mode by pressing F11 ;-)

 The code is available at https://github.com/gmarty/Mozilla-Dev-Derby-2011-08

 This demo is built using several open source projects:

 Tetris game (https://github.com/Rayomnd/tetrisgame) by Daihua Ye
 Closure Library (http://code.google.com/closure/library/)

 Follow me on Twitter: https://twitter.com/g_marty

 -----

 Original copyright of Tetris game by Daihua Ye:

 Copyright (c) 2010, Daihua Ye
 All rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are met:

 Redistributions may not be sold, nor may they be used in a commercial
 product or activity.

 Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 Redistributions in binary form must reproduce the above copyright
 notice, this list of conditions and the following disclaimer in the
 documentation and/or other materials provided with the distribution.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 POSSIBILITY OF SUCH DAMAGE.
*/
var W,rc,oc,sc,qc,nc,tc,X,V,Y,mc,Z;U.C={B:0};U.keyCode={key:0};U.P={ua:0,Ja:[]};U.F={M:1};U.j=[];U.v={end:!1};U.Fa={k:0};U.A={k:800};U.bb=function(){this.r=!1;this.color=0};function $(){this.y=this.x=this.rotation=this.pattern=0}U.nb=function(){var a,b;for(a=0;a<=U.b.oa;a++)for(b=0;b<=U.b.g;b++){if(U.j[a*U.b.g+b]===e)var c=new U.bb;U.j[a*U.b.g+b]=c}};
U.lb=function(){if(sc==="Pause Game")sc="Start Game",tc.innerHTML="Pause",document.onkeydown=function(a){a=a===i?window.event.keyCode:a.keyCode;if(a===80){sc="Pause Game";U.b.v();if(U.v.end===!1)U.C.B=setInterval(function(){U.a.move(V,W,X,Y)},U.A.k);tc.innerHTML=""}else a===82&&U.sa()},clearInterval(U.C.B);else{sc="Pause Game";U.b.v();if(U.v.end===!1)U.C.B=setInterval(function(){U.a.move(V,W,X,Y)},U.A.k);tc.innerHTML=""}};
U.sa=function(){W=P("canvas");rc=P("visible-canvas");oc=Yb()[0];sc="Pause Game";qc=P("blockimg");nc=P("gameover");tc=P("pausescene");X=W.getContext("2d");V=rc.getContext("2d");Y=new $;mc=new $;Z=new $;U.keyCode.key=0;U.P.ua=0;U.F.M=1;U.Fa.k=0;U.A.k=800;U.P.Ja=[];U.v.end=!1;U.Q=!1;nc.innerHTML="";tc.innerHTML="";U.j=[];U.nb();U.b.Ga();U.a.I(V,W,X,"white");U.a.Ta(V,W,X);U.a.Ya(Y);U.a.copy(Y,Z);U.b.Xa();clearInterval(U.C.B);U.C.B=setInterval(function(){U.a.move(V,W,X,Y)},U.A.k)};window.tetris=U;
window.tetris.restartgame=U.sa;}).call(window)
